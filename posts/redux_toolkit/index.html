<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title> Redux_toolkit - </title>
  <meta name="description" content="" />
  <meta property="og:title" content="Redux_toolkit" />
  <meta name="twitter:title" content="Redux_toolkit" />
  <meta name="description" content="redux tookit官方模板框架">
  <meta property="og:description" content="redux tookit官方模板框架">
  <meta name="twitter:description" content="redux tookit官方模板框架">
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://www.51hint.com/posts/redux_toolkit/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="IT技术分享" />

  <meta name="generator" content="Hugo 0.81.0" />
  <link rel="canonical" href="https://www.51hint.com/posts/redux_toolkit/" />
  <link rel="alternate" href="https://www.51hint.com/index.xml" type="application/rss+xml" title="IT技术分享">
  
  
  <script src="https://www.51hint.com/js/jquery-1.12.4.min.js"></script>
  <link rel="stylesheet" href="https://www.51hint.com/css/katex.min.css" />
  <link rel="stylesheet" href="https://www.51hint.com/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://www.51hint.com/css/bootstrap.min.css" />
  
  
  
  <link rel="stylesheet" href="https://www.51hint.com/css/main.css" />
  
  
  
  



<link rel="stylesheet" href="https://www.51hint.com/css/photoswipe.css" />
<link rel="stylesheet" href="https://www.51hint.com/css/default-skin/default-skin.css" />





<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>




<link rel="stylesheet" href="https://www.51hint.com/css/styles/atom-one-dark.css" />
<script src="https://www.51hint.com/js/highlight.pack.js"></script>

<script>hljs.initHighlightingOnLoad();</script>
</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.51hint.com/">IT技术分享</a>
    </div>
    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        

        

        
        
          <li>
            <a id="mSearch" href="#modalSearch" data-toggle="modal" data-target="#modalSearch" style="outline: none;">
              <span class="hidden-sm hidden-md hidden-lg">Search</span> <span id="searchGlyph" class="glyphicon glyphicon-search"></span>
            </a>
          </li>
          
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>







    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-md-12 col-md-offset-0">
            <div class="posts-heading">
                <h1 align="center">Redux_toolkit</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>




<div id="fastSearch">
  <input id="searchInput" tabindex="0">
  <ul id="searchResults">
  </ul>
</div>

<script src="/js/fuse.min.js"></script>
<script src="/js/fastsearch.js"></script>
<link rel="stylesheet" href="https://www.51hint.com/css/fast.css" />
    
<div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
        <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1">
            
            
              
            <article role="main" class="blog-post" itemprop="articleBody" id="content">
                

                <h4 id="redux-tookit">redux tookit</h4>
<p><a href="https://redux-toolkit.js.org/">https://redux-toolkit.js.org/</a></p>
<p>如果你的React项目中使用react hook、redux、redux-thunk，可能你需要用 redux-toolkit （以下简称RTK）优化你的项目结构，它看起来可以这么清爽</p>
<h3 id="redux-使用常见问题">Redux 使用常见问题</h3>
<ul>
<li>配置复杂，devtool&hellip;</li>
<li>模板代码太多，创建constant，action，reducer&hellip;</li>
<li>需要添加很多依赖包，如redux-thunk、immer&hellip;</li>
</ul>
<pre><code># 优化前
 /counter
    constants.ts
    actions.ts
    reducer.ts
    saga.ts
    index.tsxÏ
# 优化后
/counter
    slice.ts
    index.tsx
复制代码
</code></pre><h3 id="rtk干了哪些事">RTK干了哪些事？</h3>
<ul>
<li><code>configureStore()</code> 包裹createStore，并集成了<code>redux-thunk</code>、<code>Redux DevTools Extension</code>，默认开启</li>
<li><code>createReducer()</code> 创建一个reducer，action type 映射到 case reducer 函数中，不用写switch-case，并集成<code>immer</code></li>
<li><code>createAction()</code> 创建一个action，传入动作类型字符串，返回动作函数</li>
<li><code>createSlice()</code> 创建一个slice，包含 createReducer、createAction的所有功能</li>
<li><code>createAsyncThunk()</code> 创建一个thunk，接受一个动作类型字符串和一个Promise的函数</li>
<li>&hellip;</li>
</ul>
<hr>
<h2 id="apis">APIs</h2>
<h3 id="configurestore">configureStore</h3>
<blockquote>
<p><a href="https://redux-toolkit.js.org/api/configurestore/">configureStore</a> @ Redux Toolkit</p>
</blockquote>
<p>在 redux 中原本就有 <code>createStore</code> 這個方法，而 <code>configureStore</code> 可以視為加強版的 <code>createStore</code>，透過 <code>configureStore()</code> 可以簡化設定的流程、結合 slice reducers、添加和 Redux 有關的 middleware、並啟用 Redux DevTools 的擴充套件。</p>
<pre><code>// Before:
import { createStore } from 'redux';
const store = createStore(counter);

// After:
import { configureStore } from '@reduxjs/toolkit';
const store = configureStore({
  reducer: counter
})
</code></pre><h3 id="createaction">createAction</h3>
<blockquote>
<p><a href="https://redux-toolkit.js.org/api/createaction/">createAction</a> @ Redux Toolkit</p>
</blockquote>
<p><code>createAction()</code> 這個工具會根據 action type 回傳對應的 action creator function，這個函式本身內建 <code>toString()</code>，因此可以不再額外定義 TYPE 常數。這個方法有效簡化在 redux 中需要先定義 action type 的常數，然後又在 action 中載入這個 action type 常數的冗長步驟。</p>
<p>透過 <code>createAction</code> 會：</p>
<ul>
<li>自動產生一個 type 為 「<code>createAction</code> 參數」的 action creator</li>
<li>執行這個 action 時，會把參數的內容直接放入 <code>action.payload</code> 中</li>
</ul>
<pre><code>import { createAction } from '@reduxjs/toolkit';

// 透過 createAction 可以產生一個 action creator
const increment = createAction('counter/increment');

let action;
// 自動產生一個 type 為 counter/increment 的 action
action = increment(); // { type: 'counter/increment', payload: undefined }

// 參數內容會自動放入 action.payload 中
action = increment(3); //  { type: 'counter/increment', payload: 3 }

// 複寫原本的 toString() 方法，因此可以直接取得該 action 的 type 名稱
increment.toString(); // 'counter/increment'
increment.type; // 'counter/increment'
</code></pre><blockquote>
<p>🔖 備註：<code>action</code> 是一個帶有 <code>type</code> 和 <code>payload</code> 的「物件」；<code>action creator</code> 是一個會產生 <code>action</code> 的「函式」。因此，這裡的 <code>createAction</code> 實際上是產生一個 <code>action creator</code> 而不是產生一個 <code>action</code>。</p>
</blockquote>
<p>原本使用 redux 的寫法：</p>
<pre><code>const INCREMENT = 'counter/increment';

// 這是一個 action creator
function increment(amount) {
  return {
    type: INCREMENT,
    payload: amount
  };
}

// 這是一個 action
const action = increment(3);  // { type: 'counter/increment', payload: 3 }
</code></pre><h3 id="createreducer">createReducer</h3>
<blockquote>
<p><a href="https://redux-toolkit.js.org/api/createreducer/">createReducer</a> @ Redux Toolkit</p>
</blockquote>
<p><code>createReducer()</code> 這個工具提供你一張 action type 和 reducer 的對應表，而不用使用 <code>switch</code> 語法，此外它自動使用 <a href="https://github.com/mweststrate/immer"><code>immer</code> library</a> 這個工具，讓你可以使用「immutable」的方式來變更資料狀態，例如，<code>state.todos[3].completed = true</code>。</p>
<pre><code>// 使用 createReducer
const increment = createAction('INCREMENT')
const decrement = createAction('DECREMENT')

// 使用 ES6 中物件的 computed property 語法
// 原本是寫 [increment.type] 但因為 increment 內建 toString() 方法，所以可以寫成 [increment]
const counter = createReducer(0, {
  [increment]: (state, action) =&gt; state + 1,
  [decrement]: (state, action) =&gt; state - 1
})
</code></pre><p>原本 Redux 中的寫法：</p>
<pre><code>// 這是一個 reducer
const counter = (state = 0, action) =&gt; {
  if (typeof state === 'undefined') {
    return 0;
  }

  switch (action.type) {
    case increment.type:
      return state + 1;
    case decrement.type:
      return state - 1;
    default:
      return state;
  }
};
</code></pre><h3 id="createslice">createSlice</h3>
<blockquote>
<p><a href="https://redux-toolkit.js.org/api/createslice/">createSlice</a> @ Redux Toolkit</p>
</blockquote>
<p>上面雖然已經有像是 <code>createAction</code> 和 <code>createReducer</code>，但如果我們能夠在一個地方同時建立 action creator、reducers 的話，管理起來應該會變得更為方便， <code>createSlice()</code> 於是產生。</p>
<p>在 <code>createSlice()</code> 這個函式中可以帶入 reducer function, slice name 和 initial state，將自動產生對應的 slice reducer，並包含對應的 action creators 和 action types 在內。</p>
<p>以剛剛的例子來說：</p>
<pre><code>// 原本使用 createAction 和 createReducer

const increment = createAction('INCREMENT')
const decrement = createAction('DECREMENT')
const counter = createReducer(0, {
  [increment]: state =&gt; state + 1,
  [decrement]: state =&gt; state - 1
})

const store = configureStore({
  reducer: counter
})

document.getElementById('increment').addEventListener('click', () =&gt; {
  store.dispatch(increment())
})
</code></pre><p>透過 <code>createSlice</code> 將自動產生 <strong>action creators</strong> 和 <strong>action types</strong>：</p>
<pre><code>// 使用 createSlice 後
const counterSlice = createSlice({
  name: 'counter',
  initialState: 0,
  reducers: {
    increment: (state, action) =&gt; state + 1,
    decrement: (state, action) =&gt; state - 1
  }
})

const store = configureStore({
  reducer: counterSlice.reducer
})

document.getElementById('increment').addEventListener('click', () =&gt; {
  store.dispatch(counterSlice.actions.increment())
})
</code></pre><p>在上述 <code>createSlice</code> 產生的 <code>counterSlice</code> 物件中有這些可用的屬性和方法：</p>
<pre><code>// slice 的名稱
counterSlice.name;    // &quot;counter&quot;

// actions type
counterSlice.actions.increment.type;      // &quot;counter/increment&quot;，一樣有內建 toString 方法
counterSlice.actions.decrement.type;      // &quot;counter/increment&quot;，一樣有內建 toString 方法

// dispatch action
counterSlice.actions.increment();  // counterSlice.actions.increment 是 action creator
counterSlice.actions.decrement();

// reducer
counterSlice.reducer;
</code></pre><h3 id="createselector">createSelector</h3>
<blockquote>
<p><a href="https://redux-toolkit.js.org/api/createSelector">createSelector</a> @ Redux Toolkit</p>
</blockquote>
<p><code>createSelector</code> 這個工具來自 <a href="https://github.com/reduxjs/reselect">Reselect</a> 這個套件。</p>
<hr>
<h2 id="將-redux-starter-kit-整合進專案的步驟">將 Redux Starter Kit 整合進專案的步驟</h2>
<h3 id="packages">Packages</h3>
<ul>
<li><a href="https://redux.js.org/">redux</a></li>
<li><a href="https://react-redux.js.org/">react-redux</a></li>
<li><a href="https://redux-toolkit.js.org/">@reduxjs/toolkit</a></li>
</ul>
<h3 id="step-1-create-reducer">STEP 1: Create Reducer</h3>
<pre><code>// ./reducers.js
import { combineReducers } from 'redux';
// import reducers here...
import postsSlice from './slices/posts';

const rootReducer = combineReducers({
  // combine reducers here...
  posts: postsSlice.reducer,
});

export default rootReducer;
</code></pre><h3 id="step-2-createstore">STEP 2: createStore</h3>
<pre><code>// ./store.js
import { configureStore } from 'redux-starter-kit';
import rootReducer from './reducers';

export default function configureAppStore(preloadedState) {
  const store = configureStore({
    reducer: rootReducer,
    preloadedState
  });

  // handle hot reloading
  if (process.env.NODE_ENV !== 'production' &amp;&amp; module.hot) {
    module.hot.accept('./reducers', () =&gt; store.replaceReducer(rootReducer));
  }

  return store;
}
</code></pre><h3 id="step-3-mount-store">STEP 3: Mount Store</h3>
<pre><code>// ./index.js
import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './components/App';
import { Provider } from 'react-redux';
import configureAppStore from './store';

const store = configureAppStore();

ReactDOM.render(
  &lt;Provider store={store}&gt;
    &lt;App /&gt;
  &lt;/Provider&gt;,
  document.getElementById('root')
);
</code></pre><p>Tags: <a href="https://pjchender.github.io/tags#redux">redux</a></p>

            </article>

            <ul class="pager blog-pager">
                
                <li class="previous">
                    <a href="https://www.51hint.com/posts/react_redux%E8%AE%B2%E8%A7%A3/" data-toggle="tooltip" data-placement="top" title="React_redux讲解">&larr; Previous Post</a>
                </li>
                 
                <li class="next">
                    <a href="https://www.51hint.com/posts/umijs_davjs%E5%85%A5%E9%97%A8/" data-toggle="tooltip" data-placement="top" title="Umijs_davjs入门">Next Post &rarr;</a>
                </li>
                
            </ul>
            
            <div>
                 
                <h2>See Also</h2>
                <ul>
                    
                    <li><a href="/posts/react_redux%E8%AE%B2%E8%A7%A3/">React_redux讲解</a></li>
                    
                    <li><a href="/posts/react-native-training-redux-4-ways/">react-native-training/redux-4-ways</a></li>
                    
                    <li><a href="/posts/react-reduxyong-fa/">React-Redux用法</a></li>
                    
                    <li><a href="/posts/redux/">redux</a></li>
                    
                    <li><a href="/posts/gorm%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2/">Gorm关联查询</a></li>
                    
                </ul>
                
            </div>
            
            
            
              
            </div>
            
            
        </div>
    </div>
    </section>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
        
          
          
        </ul>
        <p class="credits copyright text-muted">
        &copy;2017-2018
          
          
          
            &nbsp;&bull;&nbsp;
            <a href="https://www.51hint.com/">IT技术分享</a>
          
        </p>
        <p class="credits theme-by text-muted">
          
        </p>

        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.81.0</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/rootsongjc/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>




<script src="https://www.51hint.com/js/bootstrap.min.js"></script>
<script src="https://www.51hint.com/js/photoswipe-ui-default.min.js"></script>
<script src="https://www.51hint.com/js/photoswipe.min.js"></script>
<script src="https://www.51hint.com/js/auto-render.min.js"></script>
<script src="https://www.51hint.com/js/main.js"></script>
<script src="https://www.51hint.com/js/prism.js"></script>
<script src="https://www.51hint.com/js/katex.min.js"></script>

<script> renderMathInElement(document.body); </script>







  </body>
</html>

