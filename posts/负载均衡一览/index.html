<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title> 负载均衡一览 - </title>
  <meta name="description" content="" />
  <meta property="og:title" content="负载均衡一览" />
  <meta name="twitter:title" content="负载均衡一览" />
  <meta name="description" content="负载均衡技术一览">
  <meta property="og:description" content="负载均衡技术一览">
  <meta name="twitter:description" content="负载均衡技术一览">
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://www.51hint.com/posts/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%80%E8%A7%88/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="IT技术分享" />

  <meta name="generator" content="Hugo 0.81.0" />
  <link rel="canonical" href="https://www.51hint.com/posts/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%80%E8%A7%88/" />
  <link rel="alternate" href="https://www.51hint.com/index.xml" type="application/rss+xml" title="IT技术分享">
  
  
  <script src="https://www.51hint.com/js/jquery-1.12.4.min.js"></script>
  <link rel="stylesheet" href="https://www.51hint.com/css/katex.min.css" />
  <link rel="stylesheet" href="https://www.51hint.com/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://www.51hint.com/css/bootstrap.min.css" />
  
  
  
  <link rel="stylesheet" href="https://www.51hint.com/css/main.css" />
  
  
  
  



<link rel="stylesheet" href="https://www.51hint.com/css/photoswipe.css" />
<link rel="stylesheet" href="https://www.51hint.com/css/default-skin/default-skin.css" />





<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>




<link rel="stylesheet" href="https://www.51hint.com/css/styles/atom-one-dark.css" />
<script src="https://www.51hint.com/js/highlight.pack.js"></script>

<script>hljs.initHighlightingOnLoad();</script>
</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.51hint.com/">IT技术分享</a>
    </div>
    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        

        

        
        
          <li>
            <a id="mSearch" href="#modalSearch" data-toggle="modal" data-target="#modalSearch" style="outline: none;">
              <span class="hidden-sm hidden-md hidden-lg">Search</span> <span id="searchGlyph" class="glyphicon glyphicon-search"></span>
            </a>
          </li>
          
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>







    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-md-12 col-md-offset-0">
            <div class="posts-heading">
                <h1 align="center">负载均衡一览</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>




<div id="fastSearch">
  <input id="searchInput" tabindex="0">
  <ul id="searchResults">
  </ul>
</div>

<script src="/js/fuse.min.js"></script>
<script src="/js/fastsearch.js"></script>
<link rel="stylesheet" href="https://www.51hint.com/css/fast.css" />
    
<div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
        <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1">
            
            
              
            <article role="main" class="blog-post" itemprop="articleBody" id="content">
                

                <p><strong>一、问题域</strong></p>
<p>nginx、lvs、keepalived、f5、DNS轮询，往往讨论的是接入层的这样几个问题：</p>
<p>1）<strong>可用性</strong>：任何一台机器挂了，服务受不受影响</p>
<p>2）<strong>扩展性</strong>：能否通过增加机器，扩充系统的性能</p>
<p>3）<strong>反向代理+负载均衡</strong>：请求是否均匀分摊到后端的操作单元执行</p>
<p>二、上面那些名词都是什么概念**</p>
<p>1）<strong>nginx</strong>：一个高性能的web-server和实施反向代理的软件</p>
<p>2）<strong>lvs</strong>：Linux Virtual Server，使用集群技术，实现在linux操作系统层面的一个高性能、高可用、负载均衡服务器</p>
<p>3）<strong>keepalived</strong>：一款用来检测服务状态存活性的软件，常用来做高可用</p>
<p>4）<strong>f5</strong>：一个高性能、高可用、负载均衡的硬件设备</p>
<p>5）<strong>DNS轮询</strong>：通过在DNS-server上对一个域名设置多个ip解析，来扩充web-server性能及实施负载均衡的技术</p>
<hr>
<p><strong>三、接入层技术演进</strong></p>
<p><strong>【裸奔时代单机架构】</strong></p>
<p><img src="https://images2015.cnblogs.com/blog/990532/201702/990532-20170216161829910-1423881507.png" alt="img"></p>
<p>裸奔时代的架构图如上：</p>
<p>1）浏览器通过DNS-server，域名解析到ip</p>
<p>2）浏览器通过ip访问web-server</p>
<p><strong>缺点</strong>：</p>
<p>1）非高可用，web-server挂了整个系统就挂了</p>
<p>2）扩展性差，当吞吐量达到web-server上限时，无法扩容</p>
<p>注：单机不涉及负载均衡的问题</p>
<p><strong>【DNS轮询】</strong></p>
<p>假设tomcat的吞吐量是1000次每秒，当系统总吞吐量达到3000时，如何扩容是首先要解决的问题，DNS轮询是一个很容易想到的方案：</p>
<p><img src="https://images2015.cnblogs.com/blog/990532/201702/990532-20170216162305738-1116529341.png" alt="img"></p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJDQzA1MTVGNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJDQzA1MTYwNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNDMDUxNUQ2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNDMDUxNUU2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6p+a6fAAAAD0lEQVR42mJ89/Y1QIABAAWXAsgVS/hWAAAAAElFTkSuQmCC" alt="img">
此时的架构图如上：</p>
<p>1）多部署几份web-server，1个tomcat抗1000，部署3个tomcat就能抗3000</p>
<p>2）在DNS-server层面，域名每次解析到不同的ip</p>
<p><strong>优点</strong>：</p>
<p>1）零成本：在DNS-server上多配几个ip即可，功能也不收费</p>
<p>2）部署简单：多部署几个web-server即可，原系统架构不需要做任何改造</p>
<p>3）负载均衡：变成了多机，但负载基本是均衡的</p>
<p><strong>缺点</strong>：</p>
<p>1）非高可用：<strong>DNS-server只负责域名解析ip，这个ip对应的服务是否可用，DNS-server是不保证的</strong>，假设有一个web-server挂了，部分服务会受到影响</p>
<p>2）扩容非实时：DNS解析有一个生效周期</p>
<p>3）暴露了太多的外网ip</p>
<p><strong>【nginx】</strong></p>
<p>tomcat的性能较差，但nginx作为反向代理的性能就强多了，假设线上跑到1w，就比tomcat高了10倍，可以利用这个特性来做扩容：</p>
<p><img src="https://images2015.cnblogs.com/blog/990532/201702/990532-20170216162424144-262000199.png" alt="img"></p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJDQzA1MTVGNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJDQzA1MTYwNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNDMDUxNUQ2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNDMDUxNUU2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6p+a6fAAAAD0lEQVR42mJ89/Y1QIABAAWXAsgVS/hWAAAAAElFTkSuQmCC" alt="img">
此时的架构图如上：</p>
<p>1）站点层与浏览器层之间加入了一个反向代理层，利用高性能的nginx来做反向代理</p>
<p>2）nginx将http请求分发给后端多个web-server</p>
<p><strong>优点</strong>：</p>
<p>1）DNS-server不需要动</p>
<p>2）负载均衡：通过nginx来保证</p>
<p>3）只暴露一个外网ip，nginx-&gt;tomcat之间使用内网访问</p>
<p>4）扩容实时：nginx内部可控，随时增加web-server随时实时扩容</p>
<p>5）能够保证站点层的可用性：任何一台tomcat挂了，nginx可以将流量迁移到其他tomcat</p>
<p><strong>缺点</strong>：</p>
<p>1）时延增加+架构更复杂了：中间多加了一个反向代理层</p>
<p>2）反向代理层成了单点，非高可用</p>
<p>【高可用方案keepalived】**</p>
<p>为了解决高可用的问题，keepalived出场了：</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJDQzA1MTVGNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJDQzA1MTYwNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNDMDUxNUQ2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNDMDUxNUU2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6p+a6fAAAAD0lEQVR42mJ89/Y1QIABAAWXAsgVS/hWAAAAAElFTkSuQmCC" alt="img"><img src="https://images2015.cnblogs.com/blog/990532/201702/990532-20170216162643207-412172651.png" alt="img"></p>
<p>此时：</p>
<p>1）做两台nginx组成一个集群，分别部署上keepalived，设置成相同的虚IP，保证nginx的高可用</p>
<p>2）当一台nginx挂了，keepalived能够探测到，并将流量自动迁移到另一台nginx上，整个过程对调用方透明。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJDQzA1MTVGNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJDQzA1MTYwNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNDMDUxNUQ2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNDMDUxNUU2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6p+a6fAAAAD0lEQVR42mJ89/Y1QIABAAWXAsgVS/hWAAAAAElFTkSuQmCC" alt="img">
<strong>优点</strong>：</p>
<p>1）解决了高可用的问题</p>
<p><strong>缺点</strong>：</p>
<p>1）资源利用率只有50%</p>
<p>2）nginx仍然是接入单点，<strong>如果接入吞吐量超过的nginx的性能上限怎么办，例如qps达到了50000呢？</strong></p>
<p>【垂直扩容方案 lvs/f5】**</p>
<p>nginx毕竟是软件，性能比tomcat好，但总有个上限，超出了上限，还是扛不住。</p>
<p>lvs就不一样了，它实施在操作系统层面；f5的性能又更好了，它实施在硬件层面；它们性能比nginx好很多，例如每秒可以抗10w，这样可以利用他们来扩容，常见的架构图如下：</p>
<p><img src="https://images2015.cnblogs.com/blog/990532/201702/990532-20170216162834925-2093228869.png" alt="img"></p>
<p>此时：</p>
<p>1）如果通过nginx可以扩展多个tomcat一样，可以通过lvs来扩展多个nginx</p>
<p>2）通过keepalived+VIP的方案可以保证可用性</p>
<p><strong>多数的公司到这一步基本就能解决接入层高可用、扩展性、负载均衡的问题。</strong></p>
<p>好吧，不管是使用lvs还是f5，这些都是scale up(垂直扩展)的方案，根本上，lvs/f5还是会有性能上限，假设每秒能处理10w的请求，一天也只能处理80亿的请求（10w秒吞吐量*8w秒），那万一<strong>系统的日PV超过80亿怎么办呢？</strong></p>
<p><strong>【水平扩容方案DNS轮询】</strong></p>
<p>水平扩展，才是解决性能问题的根本方案，能够通过加机器扩充性能的方案才具备最好的扩展性。</p>
<p>facebook，google，baidu的PV是不是超过80亿呢，它们的域名只对应一个ip么**，还是得通过DNS轮询来进行扩容**：</p>
<p><img src="https://images2015.cnblogs.com/blog/990532/201702/990532-20170216163345160-130223330.png" alt="img"></p>
<p>此时：</p>
<p>1）通过DNS轮询来线性扩展入口lvs层的性能</p>
<p>2）通过keepalived来保证高可用</p>
<p>3）通过lvs来扩展多个nginx</p>
<p>4）通过nginx来做负载均衡，业务七层路由</p>
<h3 id="四总结"><strong>四</strong>、总结</h3>
<p>稍微做一个简要的总结：</p>
<p>1）<strong>接入层架构要考虑的问题域为</strong>：高可用、扩展性、反向代理+扩展均衡</p>
<p>2）nginx、keepalived、lvs、f5可以很好的解决<strong>高可用、扩展性、反向代理+扩展均衡</strong>的问题</p>
<p>3）水平扩展scale out是解决扩展性问题的根本方案，<strong>DNS轮询是不能完全被nginx/lvs/f5所替代的</strong></p>
<blockquote>
<blockquote>
<p>根据软硬件划分：</p>
<ul>
<li>硬件负载均衡：
<ul>
<li>F5 的 BIG-IP</li>
<li>Citrix 的 NetScaler</li>
<li>这类硬件负载均衡器通常能同时提供四层和七层负载均衡，但同时也价格不菲</li>
</ul>
</li>
<li>软件负载均衡：
<ul>
<li>TCP 层：LVS，HaProxy，Nginx</li>
<li>基于 HTTP 协议：Haproxy，Nginx，ATS（Apache Traffic Server），squid，varnish</li>
<li>基于 MySQL 协议：mysql-proxy</li>
</ul>
</li>
</ul>
</blockquote>
</blockquote>
<hr>
<h3 id="有哪些dns服务商支持负载均衡呢">有哪些DNS服务商支持负载均衡呢？</h3>
<ol>
<li><a href="http://aws.amazon.com/cn/route53/"><strong>AWS Route 53</strong></a></li>
<li><a href="https://nsone.net/">NSONE</a></li>
<li><a href="http://dyn.com/">Dyn</a></li>
<li><a href="https://dnspod.cn/"><strong>dnspod</strong></a></li>
</ol>
<p>其中1和4是我们已经在使用的，效果比较理想。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">.com的dns域名服务器也是13台，它们是<span class="o">[</span>a-m<span class="o">]</span>.gtld-servers.net，我们随便选一台来找找github.com的SOA
dig @a.gtld-servers.net github.com

OK，我们获取了四个SOA服务器ns<span class="o">[</span>1-4<span class="o">]</span>.p16.dynect.net，再随便选一个来问问github.com对应的记录吧
 dig @ns1.p16.dynect.net github.com

</code></pre></div><h3 id="部署阶段">部署阶段</h3>
<p>第一阶段：利用Nginx或HAProxy进行单点的负载均衡，这一阶段服务器规模刚脱离开单服务器、单数据库的模式，需要一定的负载均衡，但是仍然规模较小没有专业的维护团队来进行维护，也没有需要进行大规模的网站部署。这样利用Nginx或HAproxy就是第一选择，此时这些东西上手快， 配置容易，在七层之上利用HTTP协议就可以。这时是第一选择。</p>
<blockquote>
<p>第二阶段：随着网络服务进一步扩大，这时单点的Nginx已经不能满足，这时使用LVS或者商用Array就是首要选择，Nginx此时就作为LVS或者Array的节点来使用，具体LVS或Array的是选择是根据公司规模和预算来选择，**Array的应用交付功能非常强大，本人在某项目中使用过，性价比也远高于F5，商用首选！**但是一般来说这阶段相关人才跟不上业务的提升，所以购买商业负载均衡已经成为了必经之路。</p>
</blockquote>
<p>第三阶段：这时网络服务已经成为主流产品，此时随着公司知名度也进一步扩展，相关人才的能力以及数量也随之提升，这时无论从开发适合自身产品的定制，以及降低成本来讲开源的LVS，已经成为首选，这时LVS会成为主流。
最终形成比较理想的基本架构为：<strong>Array/LVS — Nginx/Haproxy — Squid/Varnish — AppServer</strong>。</p>
<h4 id="haproxy负载">haproxy负载</h4>
<p><a href="https://www.jianshu.com/p/c9f6d55288c0">https://www.jianshu.com/p/c9f6d55288c0</a></p>
<p><a href="http://einverne.github.io/post/2019/01/load-balance-haproxy.html">http://einverne.github.io/post/2019/01/load-balance-haproxy.html</a></p>
<p><a href="http://topspeedsnail.com/centos-nginx-haproxy/">http://topspeedsnail.com/centos-nginx-haproxy/</a></p>
<p><a href="https://www.jianshu.com/p/a7e3199a0a09">https://www.jianshu.com/p/a7e3199a0a09</a></p>
<p><a href="http://www.ha97.com/5646.html">http://www.ha97.com/5646.html</a></p>

            </article>

            <ul class="pager blog-pager">
                
                <li class="previous">
                    <a href="https://www.51hint.com/posts/harbor/" data-toggle="tooltip" data-placement="top" title="Harbor">&larr; Previous Post</a>
                </li>
                 
                <li class="next">
                    <a href="https://www.51hint.com/posts/%E5%88%A0%E9%99%A4docker%E9%95%9C%E5%83%8F/" data-toggle="tooltip" data-placement="top" title="删除docker镜像">Next Post &rarr;</a>
                </li>
                
            </ul>
            
            <div>
                 
                <h2>See Also</h2>
                <ul>
                    
                    <li><a href="/posts/harbor/">Harbor</a></li>
                    
                    <li><a href="/posts/terraform/">Terraform</a></li>
                    
                    <li><a href="/posts/istio%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">Istio服务治理</a></li>
                    
                    <li><a href="/posts/helm%E5%85%A5%E9%97%A8/">Helm入门</a></li>
                    
                    <li><a href="/posts/webrtc%E5%85%A5%E9%97%A8/">Webrtc入门</a></li>
                    
                </ul>
                
            </div>
            
            
            
              
            </div>
            
            
        </div>
    </div>
    </section>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
        
          
          
        </ul>
        <p class="credits copyright text-muted">
        &copy;2017-2018
          
          
          
            &nbsp;&bull;&nbsp;
            <a href="https://www.51hint.com/">IT技术分享</a>
          
        </p>
        <p class="credits theme-by text-muted">
          
        </p>

        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.81.0</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/rootsongjc/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>




<script src="https://www.51hint.com/js/bootstrap.min.js"></script>
<script src="https://www.51hint.com/js/photoswipe-ui-default.min.js"></script>
<script src="https://www.51hint.com/js/photoswipe.min.js"></script>
<script src="https://www.51hint.com/js/auto-render.min.js"></script>
<script src="https://www.51hint.com/js/main.js"></script>
<script src="https://www.51hint.com/js/prism.js"></script>
<script src="https://www.51hint.com/js/katex.min.js"></script>

<script> renderMathInElement(document.body); </script>







  </body>
</html>

